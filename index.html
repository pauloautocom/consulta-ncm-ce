<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Consulta NCM e CClassTrib - CE</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f6f8; padding:20px; }
    .card { background:#fff; max-width:800px; margin:auto; padding:20px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,.1); }
    h1 { font-size:22px; margin-bottom:10px; }
    label { font-weight:bold; display:block; margin-top:12px; }
    input, select, button { width:100%; padding:10px; margin-top:6px; }
    button { background:#2563eb; color:#fff; border:none; border-radius:6px; margin-top:15px; cursor:pointer; font-size:16px; }
    button:hover { background:#1e40af; }
    .resultado { background:#eef6ff; padding:15px; margin-top:20px; border-radius:8px; display:none; }
    .erro { background:#fee2e2; padding:15px; margin-top:20px; border-radius:8px; display:none; }
    .small { font-size:12px; color:#555; }
  </style>
</head>
<body>

<div class="card">
  <h1>Consulta NCM e CClassTrib</h1>
  <p class="small">Estado do Ceará (CE) – busca inteligente por nome ou NCM</p>

  <label>Produto ou mercadoria</label>
  <input type="text" id="busca" placeholder="Ex: coca cola, refrigerante, batata palha, mouse ou NCM" />

  <label>Regime Tributário</label>
  <select id="regime">
    <option value="SN">Simples Nacional</option>
    <option value="LP">Lucro Presumido</option>
    <option value="LR">Lucro Real</option>
  </select>

  <button onclick="consultar()">Consultar</button>

  <div id="resultado" class="resultado"></div>
  <div id="erro" class="erro"></div>
</div>

<script>
const base = [
  { termos: ["refrigerante","coca cola","guarana","fanta","bebida gaseificada"], ncm: "22021000", descricao: "Refrigerantes", cclass: "000002" },
  { termos: ["agua","agua mineral"], ncm: "22011000", descricao: "Água mineral", cclass: "000001" },
  { termos: ["batata palha","batata processada"], ncm: "20041000", descricao: "Batatas preparadas ou conservadas", cclass: "000001" },
  { termos: ["arroz"], ncm: "10063021", descricao: "Arroz beneficiado", cclass: "000001" },
  { termos: ["feijao","feijão"], ncm: "07133329", descricao: "Feijão", cclass: "000001" },
  { termos: ["mouse"], ncm: "84716053", descricao: "Mouse", cclass: "000001" },
  { termos: ["teclado"], ncm: "84716052", descricao: "Teclado", cclass: "000001" },
  { termos: ["cabo usb","usb"], ncm: "85444200", descricao: "Cabo USB", cclass: "000001" }
];

function normalizar(txt) {
  return txt.toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu, '');
}

function consultar() {
  const termo = normalizar(document.getElementById('busca').value);
  const regime = document.getElementById('regime').value;
  const resultado = document.getElementById('resultado');
  const erro = document.getElementById('erro');

  resultado.style.display = 'none';
  erro.style.display = 'none';

  if (!termo) {
    erro.style.display = 'block';
    erro.innerHTML = 'Informe um produto ou NCM.';
    return;
  }

  const ncmBusca = termo.replace(/\D/g, '');

  let encontrado = base.find(p =>
    (ncmBusca && p.ncm.startsWith(ncmBusca)) ||
    p.termos.some(t => termo.includes(normalizar(t)))
  );

  if (!encontrado) {
    erro.style.display = 'block';
    erro.innerHTML = 'Nenhum resultado encontrado.';
    return;
  }

  resultado.style.display = 'block';
  resultado.innerHTML = `
    <b>NCM:</b> ${encontrado.ncm}<br>
    <b>Descrição:</b> ${encontrado.descricao}<br><br>
    <b>CClassTrib (CE):</b> ${encontrado.cclass}<br>
    <span class="small">Regime: ${regime}</span><br><br>
    <span class="small">Resultado estimado. Confirme com contador.</span>
  `;
}
</script>

</body>
</html>
