<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Consulta NCM ‚Ä¢ CClassTrib CE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  padding:15px;
}
.container{
  max-width:720px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 2px 10px rgba(0,0,0,.1);
}
h1{text-align:center;}
input{
  width:100%;
  padding:12px;
  font-size:16px;
  margin-top:10px;
}
.result{
  margin-top:20px;
  background:#eef6ff;
  padding:15px;
  border-radius:8px;
  display:none;
}
.error{
  margin-top:20px;
  background:#fee2e2;
  padding:15px;
  border-radius:8px;
  display:none;
}
.small{font-size:13px;color:#555;}
</style>
</head>

<body>
<div class="container">
<h1>Consulta NCM e CClassTrib ‚Ä¢ CE</h1>

<input id="busca" placeholder="Digite o produto ou NCM (ex: agulha, arroz, 22011000)">

<div id="resultado" class="result"></div>
<div id="erro" class="error"></div>
</div>

<script>
const produtos = [
 {nomes:["agua mineral","agua"], ncm:"22011000", produto:"√Ågua mineral", cclass:"000010", cst:"010"},
 {nomes:["refrigerante","coca cola"], ncm:"22021000", produto:"Refrigerante", cclass:"000010", cst:"010"},
 {nomes:["cerveja"], ncm:"22030000", produto:"Cerveja", cclass:"000010", cst:"010"},
 {nomes:["arroz"], ncm:"10063021", produto:"Arroz", cclass:"000001", cst:"000"},
 {nomes:["macarrao","macarr√£o"], ncm:"19021900", produto:"Macarr√£o", cclass:"000001", cst:"000"},
 {nomes:["cafe","caf√©"], ncm:"09012100", produto:"Caf√©", cclass:"000001", cst:"000"},
 {nomes:["agulha"], ncm:"90183219", produto:"Agulha hipod√©rmica", cclass:"000010", cst:"010"},
 {nomes:["caneta"], ncm:"96081000", produto:"Caneta esferogr√°fica", cclass:"000010", cst:"010"}
];

function normalizar(txt){
 return txt.toLowerCase()
 .normalize("NFD")
 .replace(/[\u0300-\u036f]/g,"")
 .trim();
}

document.getElementById("busca").addEventListener("input", function(){
 const textoOriginal = this.value.trim();
 const texto = normalizar(textoOriginal);
 const resultado = document.getElementById("resultado");
 const erro = document.getElementById("erro");

 resultado.style.display="none";
 erro.style.display="none";

 if(texto.length < 2) return;

 let encontrado = null;

 // üîé BUSCA POR NCM
 if(/^\d+$/.test(texto)){
   encontrado = produtos.find(p => p.ncm.startsWith(texto));
 }

 // üîé BUSCA POR NOME (palavra inteira)
 if(!encontrado){
   encontrado = produtos.find(p =>
     p.nomes.some(n => normalizar(n) === texto)
   );
 }

 if(!encontrado){
   erro.style.display="block";
   erro.innerHTML = "Nenhum resultado encontrado.";
   return;
 }

 resultado.style.display="block";
 resultado.innerHTML = `
 <b>Produto identificado:</b> ${encontrado.produto}<br>
 <b>NCM:</b> ${encontrado.ncm}<br><br>
 <b>CClassTrib (CE):</b> ${encontrado.cclass}<br>
 <b>CST para CClassTrib:</b> ${encontrado.cst}<br>
 <span class="small">Confirme sempre com contador.</span>
 `;
});
</script>
</body>
</html>
